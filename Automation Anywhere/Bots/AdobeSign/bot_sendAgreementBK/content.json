{"triggers":[],"nodes":[{"uid":"5fe8f682-1148-4946-8679-8e4fc92f5d7a","commandName":"restGet","packageName":"Rest","disabled":true,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","string":"https://api.jp1.adobesign.com/api/rest/v5/base_uris"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Access-Token"}},{"key":"value","value":{"type":"STRING","string":"3AAABLblqZhC30zU3jjbUwCtVWCbDViCvL9rf8Ou9O7KLJ7D1bh00AJsVeLOGlL5d8yGWBkSwJwY2dKasSDBfM8yYEaDNsthV"}}]}]}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"agreementIdDic"}},{"uid":"d3a10ec7-b116-480b-9342-097d1aea56a1","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","string":"https://api.jp1.adobesign.com/api/rest/v5/agreements"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Content-Type"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Access-Token"}},{"key":"value","value":{"type":"STRING","string":"3AAABLblqZhBok_NdbbXab_EVpdah8FFunzhiYoa4GKbQM-oZUtYVzPvcbOJYS3TPrnmaJ3-4fUtrD6anR_4MYEIImfRV00Dq"}}]}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"jsonPostParameters","value":{"type":"STRING","string":"{\n  \"documentCreationInfo\": {\n    \"fileInfos\": [\n      {\n         \"libraryDocumentName\": \"[デモ用] SampleDoc\" \n      }\n    ],\n    \"name\": \"tantai\",\n    \"recipientSetInfos\": [\n      {\n        \"recipientSetMemberInfos\": [\n          {\n            \"email\": \"t70.ishizaki.kiyohiko@gmail.com\"\n          }\n        ],\n        \"recipientSetRole\": \"SIGNER\"},\n{\n        \"recipientSetMemberInfos\": [\n          {\n            \"email\":\"ishizaki@itso-inc.com\"\n          }\n        ],\n        \"recipientSetRole\": \"APPROVER\"\n      }\n    ],\n    \"signatureType\": \"ESIGN\",\n    \"signatureFlow\": \"SEQUENTIAL\"\n  }\n}"}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"agreementIdDic"}},{"uid":"0efbbe6e-58bb-4eed-838c-d200fb58c8ef","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"stop"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"5c4cfbf5-4868-4edd-a6d6-26367621c138","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"8ed56912-7550-49cc-ada9-bc242a959cf1","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e6c8f173-d637-4730-80fa-5084a0bd1486","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"メールアドレスと役割をJSON埋め込み開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"fa53341f-eabd-4430-9bce-7f7bb2339080","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"89dbbcae-ef97-4d0d-bdf2-6c47171d66f7","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"delimiter","value":{"type":"STRING","string":"、"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"roleAndAddress"}},{"uid":"0e47cdb2-f60e-4bd0-be99-163fab518fdf","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{        \"recipientSetMemberInfos\": [          {            \"email\": \"$roleAndAddress[1]$\"          }        ],        \"recipientSetRole\": \"$roleAndAddress[0]$\"      }"}}],"returnTo":{"type":"VARIABLE","variableName":"roleAndMailContents"}},{"uid":"6bbdcbd3-b86a-47dd-9d3b-338d89212572","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"dd20ce23-5924-41a3-906b-8495f45d2b35","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sendAgreementJsonContents$,$roleAndMailContents$"}}],"returnTo":{"type":"VARIABLE","variableName":"sendAgreementJsonContents"}}],"branches":[{"uid":"2b72bf74-baf0-4c9e-819f-0ad98a4be92a","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"c646d021-889c-4404-a4d4-6c24316596e8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$roleAndMailContents$"}}],"returnTo":{"type":"VARIABLE","variableName":"sendAgreementJsonContents"}}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$roopCount$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$roopCount$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"226e8957-a016-431e-b240-7a4e4d038b26","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$roopCount$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"roopCount"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"sendMailList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]},{"uid":"7c49d068-df04-4e31-946d-21b17f583a3d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"メールアドレスと役割を埋め込みループ終了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"cc92b02d-6a1d-4f26-b2ab-e4b9ca6f648e","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sendAgreementJsonContents$"}},{"name":"find","value":{"type":"STRING","string":"署名者"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"SIGNER"}}],"returnTo":{"type":"VARIABLE","variableName":"sendAgreementJsonContents"}},{"uid":"cb21f680-7f6e-42ed-80f3-e29fa179c1d5","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sendAgreementJsonContents$"}},{"name":"find","value":{"type":"STRING","string":"承認者"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"APPROVER"}}],"returnTo":{"type":"VARIABLE","variableName":"sendAgreementJsonContents"}},{"uid":"cbb50ae1-44c2-408d-ad85-0c9319d969f6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{\"documentCreationInfo\":{\"fileInfos\":[{\"libraryDocumentName\": \"$sendDocumentName$\"}],\"name\":\"$sendAgreementName$\",{\"recipientSetInfos\":[$sendAgreementJsonContents$],\"signatureType\":\"ESIGN\",\"signatureFlow\":\"$signatureFlow$\"}}"}}],"returnTo":{"type":"VARIABLE","variableName":"sendAgreementJson"}},{"uid":"5f57fea8-e561-4aa7-a710-7f10c5bb0cc3","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$sendAgreementJson$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"b940aa4b-849e-4a1c-a4d9-e4f45ae8d8f0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"メールアドレスと役割をJSON埋め込み完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"65e28d22-a850-47a9-bb9f-7e3e2991a7f1","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e5f909d1-1467-49e3-8b35-76d8ced3e41d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"メールアドレスと役割をJSON埋め込みエラー"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"e6add5c5-1b19-417a-b135-fa5f00095712","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"メールアドレスと役割をJSON埋め込みエラーが発生しました"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"メールアドレスと役割をJSON埋め込み"}}]},{"uid":"27b6db59-bc59-4b9f-aaf2-fa17e1d72cdd","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"2d9abce0-bfbf-4928-aaf0-7619fbe69f7f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"署名依頼API開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"7dc8c837-7919-4479-ba7a-e0c46900c507","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"18b5846e-4d07-4da8-849d-88406bd0859a","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","string":"https://api.jp1.adobesign.com/api/rest/v5/agreements"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Content-Type"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Access-Token"}},{"key":"value","value":{"type":"STRING","string":"3AAABLblqZhC30zU3jjbUwCtVWCbDViCvL9rf8Ou9O7KLJ7D1bh00AJsVeLOGlL5d8yGWBkSwJwY2dKasSDBfM8yYEaDNsthV"}}]}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"jsonPostParameters","value":{"type":"STRING","expression":"$sendAgreementJson$"}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"agreementIdDic"}},{"uid":"f327638c-e373-4738-815d-8954f093b7a5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"署名依頼API完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"3c0214f8-1009-4122-b7b5-88d1289af641","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e73773f2-cd3d-4461-a0c0-31cee8dac2a3","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"署名依頼APIエラー"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"93ea6a35-31de-49ce-b50c-81438c02c1d1","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"署名依頼APIエラーが発生しました。"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"署名依頼API"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"accessToken","description":"取得したアクセストークン","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"3AAABLblqZhBNblSh9PvjSavSZpasDzrmHD4zDEKS_KvPxqCIJfeOPCti83mG7tzYztCErFR6KsFNAszCxTym4FktDaiBG_ma"}},{"name":"sendDocumentName","description":"AdobeSign上に保存した送信したいライブラリテンプレート名","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"[デモ用]二人署名用"}},{"name":"sendAgreementJson","description":"sendAgreementのパラメータに入力するJSON","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"  \"documentCreationInfo\": {\n    \"fileInfos\": [\n      {\n        \"libraryDocumentName\": \"[デモ用] 二人署名用\"\n      }\n    ],\n    \"name\": \"test\",\n    \"recipientSetInfos\": [\n      {\n        \"recipientSetMemberInfos\": [\n          {\n            \"email\": \"ishizaki@itso-inc.com\"\n          }\n        ],\n        \"recipientSetRole\": \"SIGNER\"\n      }\n    ],\n    \"signatureType\": \"ESIGN\",\n    \"signatureFlow\": \"SEQUENTIAL\"\n  }\n}"}},{"name":"sendAgreementName","description":"メールで表示される契約名","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"署名依頼テスト"}},{"name":"sendAgreementJsonContents","description":"Json加工用","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"signatureFlow","description":"順番に送信する場合SEQUENTIAL、同時に送信する場合APPROVER","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"SEQUENTIAL"}},{"name":"sendMailList","description":"署名依頼を送信する順番に相手の情報入力、役割(署名者か承認者か判別)とメールアドレス　例、署名者、sample@test.jp","type":"LIST","readOnly":false,"input":true,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"署名者、fujiwara@itso-inc.com"},{"type":"STRING","string":"承認者、ishizaki@itso-inc.com"}]}},{"name":"roleAndAddress","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"roopCount","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"roleAndMailContents","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"logFilePath","description":"logを保存するファイルのパス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\RPA\\Log\\A2019log.txt"}},{"name":"agreementIdDic","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}}],"breakpoints":[],"packages":[{"name":"If","version":"2.1.0-20200921-085758"},{"name":"Rest","version":"3.1.0-20200928-231420"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"LogToFile","version":"2.2.0-20201014-042806"},{"name":"MessageBox","version":"2.1.0-20201014-042808"},{"name":"List","version":"2.2.0-20201014-042806"},{"name":"Loop","version":"2.1.0-20201014-042808"},{"name":"Number","version":"2.1.0-20201014-042823"},{"name":"String","version":"3.1.0-20201014-043052"}],"workItemTemplateName":null}