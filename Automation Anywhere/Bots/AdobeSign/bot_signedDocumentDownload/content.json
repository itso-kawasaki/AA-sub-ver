{"triggers":[],"nodes":[{"uid":"65fbc5f5-e9fb-4202-8ee8-7244d01586aa","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"IN_引数　accessToken、logFilePath、saveFolderPath\nOUT_引数　なし、saveFolderPathに署名済みドキュメント保存"}}]},{"uid":"32c95545-8c10-40f9-a9ef-20d3ced37d8a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"61cc3183-3b9b-4ef5-81ee-d8248331a11d","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d7258e03-42c4-4d6a-a1f5-3b3b1ec9e909","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"4afc20c0-948d-4657-88a9-3176a9512df0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"ログファイルあり"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"bd6758b3-edab-46f9-b567-c2ab5604e5d0","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"1a5ffc3a-c828-437a-8cb1-68277d96273a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"ログファイルなし、作成"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"5a5980f6-a36e-45ac-bf39-9e246cccd951","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"branches":[{"uid":"a167b34c-338f-42eb-bc1c-7bd943067ddd","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"9b67b86d-408c-4d34-a558-d54901b6bf2e","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$errorRowCount$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"errorRowCountSt"}},{"uid":"6e1a6bd5-9a67-46db-855d-601f599d7051","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":"$errorRowCountSt$行目、ログファイル存在確認でエラー　$errorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"82a3bd6b-f86c-44ba-af2f-da02ca0aad98","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"ログファイルの存在確認でエラーが発生しました"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"errorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"errorRowCount"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"ログファイル存在確認"}}]},{"uid":"165e87df-4a6d-4a1a-9ddc-6cef17827229","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"380cf65d-8897-4785-b0b6-e5ea7b355287","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"契約一覧取得API開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"9f436b03-36ec-497f-9f8b-d0e42f38357c","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"464e6e17-06b2-4d68-8c79-20b806835ff2","commandName":"restGet","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","string":"https://api.jp1.adobesign.com/api/rest/v5/agreements"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Access-Token"}},{"key":"value","value":{"type":"STRING","expression":"$accessToken$"}}]}]}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"agreementDic"}},{"uid":"5fb3d628-71ee-479d-b4f0-e39a685aa44a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"契約一覧取得API完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"a8802e00-3c9e-49ba-a3eb-8c4563d1df0b","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"733284a6-e058-47d7-baa2-ed43936651ac","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$errorRowCount$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"errorRowCountSt"}},{"uid":"4629d054-d271-49ca-9445-c810c5877dd3","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":"$errorRowCountSt$行目、契約一覧取得APIでエラー　$errorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"f8950d4f-3265-4278-93af-56e214a9c337","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"契約一覧取得APIでエラーが発生しました"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"errorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"errorRowCount"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"契約一覧取得API"}}]},{"uid":"bf56f491-e2f1-4e97-80aa-dd08c1db1597","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e3956e53-f66c-4856-b5e8-f1418e49e425","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"02eb9d28-eb47-4f0c-a618-d918a107fc2c","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$agreementDic{Body}$"}},{"name":"delimiter","value":{"type":"STRING","string":"},"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"agreementList"}},{"uid":"1e2e77fe-0e11-4141-84ef-192598d2852a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"署名済み契約のみループ処理"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"49a598ed-ea7f-446c-ac0f-60a0d01e59b5","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"ac874af6-5b97-44c8-b564-7f04fc71105f","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFORE"}},{"name":"beforeString","value":{"type":"STRING","string":"\"status\":\""}},{"name":"beforeOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ONLY"}},{"name":"noOfChars","value":{"type":"NUMBER","number":"6"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"signStatus"}},{"uid":"234c6040-c683-4b43-a204-5b1207468f28","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ce13b30a-4d39-4054-99fd-abbcc8bd00ae","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"002a1109-fc81-4c49-ab3e-a2fcffd77d9f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"署名済み契約文字列操作開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"6b54bb01-393e-4a71-b001-6c849a3f0a39","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"\"agreementId\":\""}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"\","}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"agreementID"}},{"uid":"5f006370-3338-4a6a-8af8-ea227fa9bfc0","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"\"name\":\""}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"\","}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"agreementName"}},{"uid":"9bcef4a6-efc3-41bc-97ac-dc0178ff43a3","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":"【署名済み】$agreementName$ダウンロード処理開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"f90734cc-1135-412c-8f7f-2db6120fa550","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"署名済み契約文字列操作完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"署名済み契約文字列操作"}}]},{"uid":"693d54b5-b1e8-48b1-8c1d-39e63147916f","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"8509f107-704e-4699-a22e-e941d214de34","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"契約ドキュメントID取得API開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"8044119d-63bf-4982-b5d9-c4e199da4794","commandName":"restGet","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"https://api.jp1.adobesign.com/api/rest/v5/agreements/$agreementID$/documents"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Access-Token"}},{"key":"value","value":{"type":"STRING","expression":"$accessToken$"}}]}]}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"documentDic"}},{"uid":"a0dce98e-6808-491a-9626-a87ae9611284","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"契約ドキュメントID取得API完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"契約ドキュメントID取得API"}}]},{"uid":"31b054a1-4560-45bb-a40f-7fbe81e9a55f","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$documentDic{Body}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"\"documentId\":\""}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"\","}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"documentID"}},{"uid":"17caee4f-ce1f-468f-a99d-7be3465f2cb1","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"33cfa513-6267-4e57-8e63-35b128a71d4f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"ドキュメントダウンロードURL取得API開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"3a5ff004-8637-45c2-addf-eb0fe9854eb1","commandName":"restGet","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"https://api.jp1.adobesign.com/api/rest/v5/agreements/$agreementID$/documents/$documentID$/url"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Access-Token"}},{"key":"value","value":{"type":"STRING","expression":"$accessToken$"}}]}]}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"documentDownloadDic"}},{"uid":"74adc091-e11b-4fff-845a-f574a5520011","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"ドキュメントダウンロードURL取得API完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"ドキュメントダウンロードURL取得API"}}]},{"uid":"9a2b11a8-dda9-4680-8357-526b0c76bfeb","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$documentDownloadDic{Body}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"\"url\":\""}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"\"}"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"downloadURL"}},{"uid":"8b3b33d4-96fd-49c6-be2c-ab1d0c4c6d2d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"ファイルをダウンロード開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"d03d2236-7ee0-4efb-b81f-d76dc4acf459","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyyMMddhhmmss"}}],"returnTo":{"type":"VARIABLE","variableName":"fileNameTimestamp"}},{"uid":"75c65481-521f-48a2-b725-83f8a292ab0a","commandName":"downloadFile","packageName":"Browser","disabled":false,"attributes":[{"name":"url","value":{"type":"STRING","expression":"$downloadURL$"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$saveFolderPath$/%E3%80%90%E7%BD%B2%E5%90%8D%E6%B8%88%E3%81%BF%E3%80%91$agreementName$$fileNameTimestamp$.pdf"}},{"name":"overwrite","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4662d180-6ab0-42ce-ad87-957860139dc8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":"【署名済み】$agreementName$ダウンロード処理終了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$signStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"SIGNED"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"agreementList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"branches":[{"uid":"4eb20431-3c55-485e-a0ce-fa90380c19f0","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"a21891d3-259e-48e2-b842-4e6aa69f06e6","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$errorRowCount$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"errorRowCountSt"}},{"uid":"7d66843c-4b4f-4bfa-8192-ab4e977e9bb5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":"$errorRowCountSt$行目、署名されている契約を抽出、ダウンロードでエラー　$errorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"a2680db3-423a-4a80-9c83-1027da72abac","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"署名されている契約を抽出、ダウンロードでエラーが発生しました"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"errorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"errorRowCount"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"署名されている契約を抽出、ダウンロード"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"agreementDic","description":"APIで取得した契約一覧JSONを変換","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"agreementList","description":"契約一覧を一つずつリスト型に分割","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"signStatus","description":"契約の状態","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"agreementID","description":"署名済み契約ID","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"documentDic","description":"APIで取得したドキュメントIDを含んだJSONを変換","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"documentID","description":"署名済み契約のドキュメントID","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"accessToken","description":"取得したアクセストークン","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"documentDownloadDic","description":"署名済みドキュメントのダウンロードURLを含んだJSONを変換","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"downloadURL","description":"署名済みドキュメントのダウンロードURL","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"agreementName","description":"署名済み契約名","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"logFilePath","description":"logを保存するファイルのパス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"saveFolderPath","description":"ダウンロードした契約書を保存するフォルダパス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"errorMessage","description":"エラー時のメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"errorRowCount","description":"エラー行のカウント","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"errorRowCountSt","description":"エラー行を表示するために文字列に変換","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"fileNameTimestamp","description":"保存ファイル名用のタイムスタンプ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"If","version":"2.1.0-20200921-085758"},{"name":"Rest","version":"3.1.0-20200928-231420"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"Comment","version":"2.2.0-20201014-042520"},{"name":"System","version":"3.0.0-20200921-090225"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"LogToFile","version":"2.2.0-20201014-042806"},{"name":"Browser","version":"2.2.0-20201002-123733"},{"name":"List","version":"2.2.0-20201014-042806"},{"name":"Loop","version":"2.1.0-20201014-042808"},{"name":"Number","version":"2.1.0-20201014-042823"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"Datetime","version":"2.2.0-20201014-042531"}],"workItemTemplateName":null}