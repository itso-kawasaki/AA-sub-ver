{"triggers":[],"nodes":[{"uid":"9a4dfb30-a55a-49c0-a5e1-b02e07e19f1f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ログファイルパス、設定ファイルパスを入力してもらう"}}]},{"uid":"5cfe44f9-4d32-4675-b433-57f4d480dc79","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\t70is\\OneDrive\\デスクトップ\\AA FrameWork\\03_Log\\log.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"logFilePath"}},{"uid":"761fb71d-33ee-4c7f-a6f3-0bf55ece1998","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\t70is\\OneDrive\\デスクトップ\\AA FrameWork\\Settings.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"strSettingPath"}},{"uid":"6f56550c-2a95-4dc4-8ab5-b969db055d5a","commandName":"assign","packageName":"File","disabled":false,"attributes":[{"name":"sourceFile","value":{"type":"FILE","expression":"file://$strSettingPath$"}}],"returnTo":{"type":"VARIABLE","variableName":"settingPath"}},{"uid":"628b0184-cfba-41ad-82cf-99a2955d8978","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f3e26516-c441-46bb-8a54-f19fda89f542","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e881ea26-03df-4713-bd92-55beb5b8fb32","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"ログファイルあり"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"b3eaaca5-02eb-4df9-a964-b44acf252391","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"375467cf-6c06-4a6d-8910-4bd91a840e75","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"ログファイルなし、作成"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"8c723cb7-1780-4526-bb97-d6aa8d6c7004","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"ログファイル存在確認"}}]},{"uid":"163d05c4-3585-47b8-9500-956b94298434","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"04ab26a4-b3df-4f9f-82de-d5996de3f58f","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"6ec79066-fea1-49c3-9d21-616776dfc7c4","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"getSetting　BOT実行"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"2bc0ec0e-ebbd-47c0-a8b3-61a39a70e059","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"settingFilePath","value":{"type":"FILE","expression":"$settingPath$"}},{"key":"logFilePath","value":{"type":"STRING","expression":"$logFilePath$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/FrameWork/getSetting"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"dicSettingVal","value":{"type":"VARIABLE","variableName":"dicSettingVal"}}]}},{"uid":"412a4c48-658a-44a1-9d77-6bdfe5735236","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"getSetting　BOT完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"設定ファイル読込"}}]},{"uid":"d18efcd3-3464-4873-a9fc-4312990f3a70","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"3b4a6591-2841-4eae-97e0-942f0b0a3251","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"Main処理開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"835cbb33-c667-4edb-b896-f6b42851739c","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$dicSettingVal{\"入力ファイ\"}$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}},{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"uid":"b7451cf1-3c3f-480f-882e-583076943646","commandName":"RunMacro","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"macroName","value":{"type":"STRING","string":"cellColor"}},{"name":"macroArgs","value":{"type":"STRING","string":""}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}]},{"uid":"aef5678c-4818-4784-b273-1a87dea96cb6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"Main処理完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Main処理"}}]}],"branches":[{"uid":"99d1f404-afc6-4193-92de-5ca6f1895569","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"62863489-c163-49f3-8051-7b34e74fe816","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$errorRowCount$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"errorRowCountSt"}},{"uid":"dcd722a4-cb8c-4e79-a2e9-c9abe815d0cd","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$dicSettingVal{\"エラー画像出力先フォルダ\"}$"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"7af37e58-7e35-4f13-b0e5-cfbeabdefee4","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":"$errorRowCountSt$行目、ログファイル存在確認エラー発生　$errorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"4add8dd0-8fac-4887-9466-2057ec73f540","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"設定ファイル読込でエラーが発生しました。"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"errorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"errorRowCount"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"logFilePath","description":"logを保存するファイルのパス","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"errorMessage","description":"エラー時のメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"errorRowCount","description":"エラー行のカウント","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"errorRowCountSt","description":"エラー行を表示するために文字列に変換","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"settingPath","description":"","type":"FILE","readOnly":false,"input":false,"output":false},{"name":"strSettingPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"tdSettingValue","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"dicSettingVal","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"drSettingVal","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"return","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"ANY","defaultValue":{"type":"DICTIONARY","dictionary":[]}}],"breakpoints":[],"packages":[{"name":"Excel_MS","version":"5.4.0-20210117-080101"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"Comment","version":"2.2.0-20201014-042520"},{"name":"Screen","version":"2.2.0-20210118-185815"},{"name":"TaskBot","version":"2.0.1-20210128-041521"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"LogToFile","version":"2.2.0-20201014-042806"},{"name":"Number","version":"2.1.0-20201014-042823"},{"name":"String","version":"3.1.0-20201014-043052"}],"migrationJournalReviewIds":[],"workItemTemplateName":null}