{"triggers":[],"nodes":[{"uid":"debae384-a06a-4e9c-999d-bc3d44d99dc2","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"'IEキー入力.vbs\n'Copyright (c) 2014 nezuq\n'This software is released under the MIT License.\n'http://opensource.org/licenses/mit-license.php\n\n'シェルを起動する\nDim wsh\nSet wsh = WScript.CreateObject(\"WScript.Shell\")\n\n'IEを起動する\nDim ie \nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = True\n'ie.FullScreen = True\n\n'IEをアクティブにする\nDim wLoc, wSvc, wEnu, wIns\nSet wLoc = CreateObject(\"WbemScripting.SWbemLocator\")\nSet wSvc = wLoc.ConnectServer\nSet wEnu = wSvc.InstancesOf(\"Win32_Process\")\nDim pId\nFor Each wIns in wEnu\n    If Not IsEmpty(wIns.ProcessId) And wIns.Description = \"iexplore.exe\" Then\n        pId = wIns.ProcessId\n    End If\nNext\nSet wLoc = Nothing\nSet wEnu = Nothing\nSet wSvc = Nothing\nWhile not wsh.AppActivate(pId) \n    Wscript.Sleep 100 \nWend \n\nsub open()\n\t'IEで指定URLを開く\n\tie.Navigate \"https://secure.nicovideo.jp/secure/login_form\"\n\tDo While ie.Busy = True Or ie.readyState <> 4\n\tLoop\n  \tWsh.AppActivate(\"iexplore.exe\")\nend sub"}}]},{"uid":"ac43381c-da09-42d8-8971-a81f18b26650","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"open"}}]},{"uid":"9f90f0c2-4e40-4be1-a5f6-aeb5b1c085e4","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"test"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"d8efb045-47fc-4481-8d4f-2cee89066dbd","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"'IEキー入力.vbs\n'Copyright (c) 2014 nezuq\n'This software is released under the MIT License.\n'http://opensource.org/licenses/mit-license.php\n\n'シェルを起動する\nDim wsh\nSet wsh = WScript.CreateObject(\"WScript.Shell\")\n\n'IEを起動する\nDim ie \nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = True\n'ie.FullScreen = True\n\n'IEをアクティブにする\nDim wLoc, wSvc, wEnu, wIns\nSet wLoc = CreateObject(\"WbemScripting.SWbemLocator\")\nSet wSvc = wLoc.ConnectServer\nSet wEnu = wSvc.InstancesOf(\"Win32_Process\")\nDim pId\nFor Each wIns in wEnu\n    If Not IsEmpty(wIns.ProcessId) And wIns.Description = \"iexplore.exe\" Then\n        pId = wIns.ProcessId\n    End If\nNext\nSet wLoc = Nothing\nSet wEnu = Nothing\nSet wSvc = Nothing\nWhile not wsh.AppActivate(pId) \n    Wscript.Sleep 100 \nWend \n\nsub open()\n\t'IEで指定URLを開く\n\tie.Navigate \"https://secure.nicovideo.jp/secure/login_form\"\n\tDo While ie.Busy = True Or ie.readyState <> 4\n\tLoop\nend sub"}}]},{"uid":"e4bcffae-1f0b-4113-b370-4fd9ab2ead39","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"open"}}]},{"uid":"67bae808-77cf-45e1-af68-012cf5f998cf","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"test"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"acf6fc78-1cc4-4238-950b-2b35d61c3582","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"Option Explicit\n\n'定数および変数の定義\n\n'ログインURL\nConst LOGIN_URL = \"https://account.nicovideo.jp/login\"\n\n\n'メインの処理\n\nDim WshShell\nSet WshShell = Wscript.CreateObject(\"WScript.Shell\")\n\nSub login()\n\tWshShell.Run \"iexplore.exe\", 3\n  \n\tWscript.Sleep 1000\n  \n    'ログインURLをアドレスバーに貼り付け\n    ie.Navigate LOGIN_URL\n\n    Wscript.Sleep 500\n\n    'ログイン画面に遷移\n    WshShell.SendKeys \"{Enter}\", True\n\nEnd Sub"}}]},{"uid":"b32c1635-9391-4e7a-a961-a13aa9252e5b","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"Option Explicit\n\n'定数および変数の定義\n\n'ログインURL\nConst LOGIN_URL = \"https://account.nicovideo.jp/login\"\n\n'ユーザID\nConst USER_ID = \"admin\"\n\n'パスワード\nConst USER_PASS = \"adminpass\"\n\n\n'メインの処理\n\nDim WshShell\nSet WshShell = Wscript.CreateObject(\"WScript.Shell\")\n\n'cscript.exe で強制実行\nCall CscriptRun\n\n'ログインする\nCall main\n\nSet WshShell = Nothing\n\n'=====================================================================================\n\n'メイン処理\n'=====================================================================================\nSub main()\n\n    Wscript.StdOut.WriteLine \"------\"\n    Wscript.StdOut.WriteLine \"ログインして、APリリースセットのダウンロードを開始します。\"\n    Wscript.StdOut.WriteLine \"アクティブなウィンドウ（Chrome）を対象にして処理を行うため、何も操作せずにお待ちください。\"\n\n    'ログインに成功するまでループ（必要に応じて）\n    'Do While Not WshShell.AppActivate(\"ダッシュボード\", True)\n        Call login\n    'Loop\n\nEnd Sub\n'=====================================================================================\n\nSub login()\n\n    'Chromeがアクティブかを確認するためのフラグ\n    Dim activeFlg\n\n    Wscript.Sleep 2000\n\n    'ログインエラーで無い場合\n    If Not WshShell.AppActivate(\"ログインエラー\", True) Then\n        'クロームを起動する(3:最大化で最前面)\n        WshShell.Run \"Chrome.exe\", 3\n        'Chromeをアクティブにする\n        Do While Not activeFlg\n            activeFlg = WshShell.AppActivate(\"新しいタブ\", True)\n        Loop\n    Else\n        WshShell.SendKeys \"{F6}\", True\n    End If\n\n    Wscript.Sleep 2000\n\n    'ログインURLをアドレスバーに貼り付け\n    WshShell.SendKeys LOGIN_URL\n\n    Wscript.Sleep 500\n\n    'ログイン画面に遷移\n    WshShell.SendKeys \"{Enter}\", True\n\n    'ログイン\n    Wscript.Sleep 2000\n\n    'ユーザ名を入力\n    WshShell.SendKeys \"{Tab}\", True\n    WshShell.SendKeys \"{Tab}\", True\n    WshShell.SendKeys USER_ID, True\n\n    Wscript.Sleep 2000\n\n    WshShell.SendKeys \"{Tab}\", True\n\n    'パスワードを入力\n    WshShell.SendKeys USER_PASS, True\n\n    Wscript.Sleep 2000\n\n    WshShell.SendKeys \"{Tab}\", True\n    Wscript.Sleep 1000\n\n    'ログインボタン押下\n    WshShell.SendKeys \"{Enter}\", True\n\n    Wscript.Sleep 500\n\nEnd Sub"}}]},{"uid":"46776fb6-6c6b-4797-bc4a-1f5fe67c2668","commandName":"vbscript.commands.closeScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false}],"breakpoints":[],"packages":[{"name":"VBScript","version":"2.5.0-20210128-041527"},{"name":"MessageBox","version":"2.1.0-20210118-185321"}],"migrationJournalReviewIds":[],"workItemTemplateName":null}