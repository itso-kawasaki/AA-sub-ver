{"triggers":[],"nodes":[{"uid":"b803b44a-05eb-4b0b-81d5-7c092bbfffb0","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"4fa9ace9-e942-47a2-8efc-4fb608154e3a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"処理1_”Settings.xlsx\"が格納されているフォルダを確認。"}}]},{"uid":"78fb1c9e-2f6e-4e17-b4b8-d7913453f1cd","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"処理2_”Settings.xlsx\"の値をディクショナリ型の変数に格納するBotを実行。"}}]},{"uid":"d0dea86f-bb9d-469f-b28e-05fda11a0fa3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"処理3_サンプル処理"}}]},{"uid":"27692413-518a-492a-ac75-50e516a4420b","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f051fead-e7f8-4316-94ff-cbdba913fea0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","expression":"$strRootDir$ に \"Settings.xlsx\" が格納されているフォルダパスまでを指定してください。"}}]},{"uid":"932aa0a6-164e-4c04-9fcc-7dea60d34d1c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\AAスターターパック_フォルダ構成\\XXX業務"}}],"returnTo":{"type":"VARIABLE","variableName":"strRootDir"}},{"uid":"c575ed6f-7c20-420d-a183-e751e6c62ad7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"設定ファイル、ログフォルダのパスを変数に代入します。"}}]},{"uid":"761fb71d-33ee-4c7f-a6f3-0bf55ece1998","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strRootDir$\\Settings.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"strSettingPath"}},{"uid":"5ca8488d-97b4-40b2-8ad9-deaec9614cf8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strRootDir$\\05_Log"}}],"returnTo":{"type":"VARIABLE","variableName":"strLogFolderPath"}},{"uid":"8e017a52-7608-43d4-9f66-a88aa4ab3685","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ログフォルダが存在するか確認します。"}}]},{"uid":"0bba93a2-9184-476b-a77c-ec4b4af8f064","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"721ece32-aed9-4f1d-9f79-05ad24bf76c6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"存在する場合、必要な処理はありません。"}}]}],"branches":[{"uid":"6aa43b1e-8464-4b42-86f7-f00a8db6c631","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"51fb1382-0652-44e0-ace0-a0ade7eed8d3","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strLogFolderPath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strLogFolderPath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]},{"uid":"55b90572-6b4f-476b-a2b5-e57c1c4b14e2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"日時文字列を取得し、ログファイル名に加えます。"}}]},{"uid":"eac3a5f3-68a9-46f7-86c2-f892a7b57c38","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyyMMddHHmmss"}}],"returnTo":{"type":"VARIABLE","variableName":"strDate"}},{"uid":"5cfe44f9-4d32-4675-b433-57f4d480dc79","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strLogFolderPath$\\log_$strDate$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"strLogFilePath"}},{"uid":"8c723cb7-1780-4526-bb97-d6aa8d6c7004","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"628b0184-cfba-41ad-82cf-99a2955d8978","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"de50b5ec-0a41-4056-b3b7-329d4aa63232","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"”Settings.xlsx\"がない場合エラーで返します。"}}]},{"uid":"813d5dd5-a341-42c0-bb20-bae3422d0ed1","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"2932f060-1403-46be-bf29-25dde0ed2b2b","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"設定ファイルあり"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"780ab55c-b763-4396-86c4-ac8606ba9a48","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"eb26fb16-81b9-4f0b-b670-051cb301246e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"設定ファイルなし"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"6a43a861-f354-495a-a5ba-4726e6bb10bd","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"エラーハンドラー:スローでエラーを発生させ処理を終了することができます。"}}]},{"uid":"9b71699f-b037-4dd2-b64e-aae43cd1bed4","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"設定ファイルが見つかりませんでした。"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$strSettingPath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"”Settings.xlsx\"存在確認"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"処理1_業務フォルダ確認"}}]},{"uid":"04ab26a4-b3df-4f9f-82de-d5996de3f58f","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"69b2c49a-8a17-4835-9cf7-bb37ddb1596b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"”Settings.xlsx\"を読み込み、ディクショナリ型の変数 ”dicSettingVal” を返します。"}}]},{"uid":"3e5eb6ed-bc7c-43a9-b6c8-d64ff3efd8a1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"エラーハンドラーは試行内でエラーが発生した場合、キャッチにてエラー発生時の処理を実行することができます。"}}]},{"uid":"163d05c4-3585-47b8-9500-956b94298434","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"6ec79066-fea1-49c3-9d21-616776dfc7c4","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"getSetting　BOT実行"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"026130ae-8995-4e10-acdc-2a9ac4ad1f85","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"設定ファイルを読み込むBot　getSettingを呼び出します。"}}]},{"uid":"ccfb9201-d54d-4b1a-b007-472c4abc55fe","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"argInStrLogFilePath","value":{"type":"STRING","expression":"$strLogFilePath$"}},{"key":"argInStrSettingPath","value":{"type":"STRING","expression":"$strSettingPath$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/FrameWork/GetSettings"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"argOutDicSettingVal","value":{"type":"VARIABLE","variableName":"dicSettingVal"}}]}},{"uid":"412a4c48-658a-44a1-9d77-6bdfe5735236","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"getSetting　BOT完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"6b946d67-8de8-4215-a507-72377a10eb70","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f9b06afc-9d48-4531-b971-2f5348aec395","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strRootDir$/$dicSettingVal{\"入力フォルダ\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"strInputFolderPath"}},{"uid":"d116e923-c5ca-4716-9257-49b4a6471af0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strRootDir$/$dicSettingVal{\"出力先フォルダ\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"strOutputFolderPath"}},{"uid":"ffb73f74-2ac6-4c41-880b-542e1569bf67","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strRootDir$/$dicSettingVal{\"中間処理出力先フォルダ\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"strWorkFolderPath"}},{"uid":"4cd27af9-e09d-4698-8778-4952d31fde74","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strRootDir$/$dicSettingVal{\"エラー画像出力先フォルダ\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"strErrorFolderPath"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"”Settings.xlsx\"から取得したフォルダー名を変数格納"}}]},{"uid":"26261403-aa71-4c67-827b-322e4a6705d5","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"62423194-3ead-4ec4-b6c5-739e95e52b88","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Outputフォルダが存在するか確認します。"}}]},{"uid":"5c9c86b7-317a-492b-8e12-d1fee694600e","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"5ed167d3-d0dd-46cc-8e92-ef0cd49982bd","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"アウトプットフォルダあり"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"f470ba0e-63d1-44dc-9bc2-d4c73dbf5163","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"22b80193-e248-4545-868c-87c11c08ab15","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"アウトプットフォルダなし、作成"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"bdc084e9-679c-4f57-985b-cab24135609b","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strOutputFolderPath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strOutputFolderPath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]},{"uid":"ab7ee5ce-3963-43f3-8328-02b6fa6df755","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Errorフォルダが存在するか確認します。"}}]},{"uid":"c7d419a7-3347-49d4-a041-5c096ca36ad1","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"fa34bc4e-9d98-49e9-9fd2-0a233bee786e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"エラーフォルダあり"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"985198a4-d279-4ff1-a161-c039324d05eb","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"210d7474-7e6a-4213-bb10-efc3f8ba3817","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"エラーフォルダなし、作成する"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"a8730236-14e0-43cf-a0a4-4e2a47e4e448","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strErrorFolderPath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strErrorFolderPath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]},{"uid":"6070f235-2352-412e-bfc6-7bfc0eab77c2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Workフォルダが存在するか確認します。"}}]},{"uid":"816d0a21-e85d-4928-9bd9-46a85c36e666","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"106531a8-376d-49c5-b1b6-3359ab817d80","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"中間処理フォルダあり"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"d382b4b5-0d8c-4bd1-a693-448a48654505","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"8622e18b-de6a-4904-9280-aab3b385fbc6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"中間処理フォルダなし、作成"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"dc59248c-9b9e-4a8d-99d2-723cb180cbe8","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strWorkFolderPath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strWorkFolderPath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"”Settings.xlsx\"から取得したフォルダーの存在確認"}}]}],"branches":[{"uid":"99d1f404-afc6-4193-92de-5ca6f1895569","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"2990cca2-0bfc-490e-b6b3-90f1b4c07998","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"エラーハンドラーキャッチにて、エラー行とエラーメッセージを変数に代入することができます。"}}]},{"uid":"28624411-1710-41bb-909a-e531cd13cd0f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ログファイルにエラー行を記載するために、エラー行が入った変数を数字型から文字列型に変換します。"}}]},{"uid":"62863489-c163-49f3-8051-7b34e74fe816","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$intErrorLineCount$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"strErrorLineCount"}},{"uid":"72eedbf8-8cbe-470f-bce9-567c79da51e8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"エラー行とエラーメッセージをログファイルに出力します。"}}]},{"uid":"7af37e58-7e35-4f13-b0e5-cfbeabdefee4","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":"$strErrorLineCount$行目、設定ファイル読込でエラー発生　$strErrorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"4add8dd0-8fac-4887-9466-2057ec73f540","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"設定ファイル読込でエラーが発生しました。"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"intErrorLineCount"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"処理2_”Settings.xlsx\"読込"}}]},{"uid":"473019c8-e069-4c2f-a0c9-a8beddc69ff0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"以下サンプル処理になります。　エラーハンドラー:試行内で実際の処理を実行します。この試行内の処理は削除いただいて構いません。"}}]},{"uid":"d18efcd3-3464-4873-a9fc-4312990f3a70","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"b4556cd2-54fe-4f7c-b405-2dd1c1fca7c5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"サンプル処理を記入。二つの入力ファイルデータをまとめ、マクロを実行。セルに色付けしたファイルを出力フォルダに保存します。"}}]},{"uid":"5a1e90a7-0c87-4a26-aecb-a548f159bba1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"エラーハンドラーは試行内でエラーが発生した場合、キャッチにてエラー発生時の処理を実行することができます。"}}]},{"uid":"7f6ab833-fc28-4e0c-9881-c39393d6c44d","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"3b4a6591-2841-4eae-97e0-942f0b0a3251","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"サンプル処理開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"3fd64b26-8eeb-459d-bcd9-abc9c54ae018","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"dcc828c7-f3cf-486f-8d0c-8dfdcdce89d3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"日時文字列を取得し、ファイル名に加えます。"}}]},{"uid":"6724e643-ea6a-443b-90ca-ea912a98827c","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyyMMddHHmmss"}}],"returnTo":{"type":"VARIABLE","variableName":"strDate"}},{"uid":"8047136e-6a51-42df-8b2f-dcaff0626bab","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strWorkFolderPath$/Work_$strDate$.xlsm"}}],"returnTo":{"type":"VARIABLE","variableName":"strWorkFilePath"}},{"uid":"97be1616-3ab8-47df-9cc2-81fb3257b0da","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Workフォルダーに作業対象のExcelファイルをコピーします。"}}]},{"uid":"ee6a2032-6d1a-485b-aac0-e6e771dad6ed","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$strInputFolderPath$/$dicSettingVal{\"入力ファイル\"}$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$strWorkFilePath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Workフォルダにファイルをコピーし、作業する"}}]},{"uid":"b4909b3e-42cf-4afc-9e0e-1aaf534c52ab","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e31c25eb-5606-487d-98f4-f2a10e512d36","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Excelファイルを開き、データを取得します。"}}]},{"uid":"835cbb33-c667-4edb-b896-f6b42851739c","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strInputFolderPath$/$dicSettingVal{\"入力ファイル2\"}$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":true}},{"name":"sheetName","value":{"type":"STRING","expression":"$dicSettingVal{\"入力ファイルシート名\"}$"}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}},{"name":"session","value":{"type":"STRING","string":"ssProcessExcelFile"}}]},{"uid":"a2feabec-aecb-4edb-92b6-0706c43fde9d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Excelファイルが開くまで待機します。"}}]},{"uid":"ca25a331-8f9e-49b5-877d-33b4b3418f10","commandName":"waitForCondition","packageName":"Wait","disabled":false,"attributes":[{"name":"conditionPredicate","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$wnExcel$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"10"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowExists","packageName":"Window"}}]},{"uid":"e8480a2b-89cd-450a-aabc-14b747c2cb44","commandName":"GetMultipleCells","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"loopSelection","value":{"type":"STRING","string":"CELL_RANGE"}},{"name":"fromCell","value":{"type":"STRING","string":"B4"}},{"name":"toCell","value":{"type":"STRING","string":"E7"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"ssProcessExcelFile"}}}],"returnTo":{"type":"VARIABLE","variableName":"dtExcelExport"}},{"uid":"972c0b14-d27a-4941-9d9b-9fe2a0d6143c","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"ssProcessExcelFile"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"コピー元のデータを、データテーブル型で取得する"}}]},{"uid":"e023b374-c654-477c-b5c2-84e293ce3724","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"コピーファイルが作成されるまで待機します。"}}]},{"uid":"c1360e3f-646b-4141-841c-de6624dff37c","commandName":"waitForCondition","packageName":"Wait","disabled":false,"attributes":[{"name":"conditionPredicate","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$strOutputFilePath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"10"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]},{"uid":"693295e9-5f53-4fad-8e54-84a9c7db70e5","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"a431b3f8-855b-4b98-bfee-96bdc59b9bb3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"コピー元データを貼り付けデータをまとめます。"}}]},{"uid":"190149eb-890b-4a1b-8516-ec8c5f1c1e02","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strWorkFilePath$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":true}},{"name":"sheetName","value":{"type":"STRING","expression":"$dicSettingVal{\"入力ファイルシート名\"}$"}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}},{"name":"session","value":{"type":"STRING","string":"ssWorkFolderProcessExcelFile"}}]},{"uid":"e279a2bc-100e-46a8-9378-8887249532c7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Excelファイルが開くまで待機します。"}}]},{"uid":"974c46bb-6a73-4a09-863e-450121e39506","commandName":"waitForCondition","packageName":"Wait","disabled":false,"attributes":[{"name":"conditionPredicate","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$wnExcel$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"10"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowExists","packageName":"Window"}}]},{"uid":"c74c6cfd-ae90-4864-904f-5fa45807590d","commandName":"writeDataTableToWorksheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"tableObj","value":{"type":"VARIABLE","variableName":"dtExcelExport"}},{"name":"sheetSelection","value":{"type":"STRING","string":"SpecificSheet"}},{"name":"fromSpecificSheet","value":{"type":"STRING","expression":"$dicSettingVal{\"入力ファイルシート名\"}$"}},{"name":"firstCellAddress","value":{"type":"STRING","string":"B8"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"ssWorkFolderProcessExcelFile"}}}]},{"uid":"aee0456c-4620-4bbe-bf8f-d01fe57b72a4","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"金額が最大、最小のセルに色を付けるマクロを実行します。"}}]},{"uid":"b7451cf1-3c3f-480f-882e-583076943646","commandName":"RunMacro","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"macroName","value":{"type":"STRING","string":"cellColor"}},{"name":"macroArgs","value":{"type":"STRING","string":""}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"ssWorkFolderProcessExcelFile"}}}]},{"uid":"466d7a23-120c-4119-a0b1-a442bbd5af96","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"ssWorkFolderProcessExcelFile"}}}]},{"uid":"a2bcc8a8-d39d-416a-9b4f-b83d14787357","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"日時文字列を取得し、ファイル名に加えます。"}}]},{"uid":"8bec1634-38f3-470e-94e8-7500bc98c703","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyyMMddHHmmss"}}],"returnTo":{"type":"VARIABLE","variableName":"strDate"}},{"uid":"beae2598-23d4-477d-90f6-73482fd15d58","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strOutputFolderPath$/Output_$strDate$.xlsm"}}],"returnTo":{"type":"VARIABLE","variableName":"strOutputFilePath"}},{"uid":"86935779-4654-4f13-beb1-c916d32667df","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"処理が完了したファイルをアウトプットフォルダにコピーします。"}}]},{"uid":"e9eae8d0-093d-46b6-951f-02908ab9e7c5","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$strWorkFilePath$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$strOutputFilePath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"インプットフォルダの2つのデータをまとめ、マクロを実行する"}}]},{"uid":"0ea1c2be-53ff-4d94-a2e0-4555f3bae2ce","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","string":"Main処理完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"518d7f8b-6754-44e2-98fe-bdac8a807eb9","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f69e498d-bf9c-4fea-a801-699048b9934e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"エラーハンドラーキャッチにて、エラー行とエラーメッセージを変数に代入することができます。"}}]},{"uid":"3362bd9d-aa84-4bb6-8028-d449d89c21e9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ログファイルにエラー行を記載するために数字型から文字列型に変換します。"}}]},{"uid":"acc7b30a-8161-47ee-90c8-9a29cdb29027","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$intErrorLineCount$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"strErrorLineCount"}},{"uid":"8a5490c6-0340-4878-a15f-49bb93dd5cc2","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyyMMddHHmmss"}}],"returnTo":{"type":"VARIABLE","variableName":"strDate"}},{"uid":"e6397d2d-41d3-42f7-929f-ba007c93119a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"エラー発生時にスクリーンショットを撮り、エラーフォルダに格納します。"}}]},{"uid":"24810666-b3ec-44a3-88a9-eaba3e69ce73","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strErrorFolderPath$/ErrorImage_$strDate$.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f59af4e9-22bc-418b-b14b-4061fae9bc20","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"エラー行とエラーメッセージをログファイルに出力します。"}}]},{"uid":"236913e3-b0be-4bf5-a09c-096a3d23e0c6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":"$strErrorLineCount$行目、Main処理でエラー発生　$strErrorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"2eb7d603-9b8c-4290-95dc-224de54284c5","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"Main処理でエラーが発生しました。"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"intErrorLineCount"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"処理3_サンプル処理"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Main"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"strSettingPath","description":"設定ファイルパス","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dicSettingVal","description":"設定ファイル読込をした値を格納","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"dtExcelExport","description":"コピー元のExcelデータ","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"strDate","description":"日付文字列を格納し、ファイル名に追記する","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strOutputFilePath","description":"アウトプット先のファイルパス","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strInputFolderPath","description":"インプットフォルダのパス","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strWorkFilePath","description":"中間処理フォルダ内のファイルパス","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strLogFilePath","description":"ログファイルパス","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strErrorMessage","description":"エラー時のメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"intErrorLineCount","description":"エラー行のカウント","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"strErrorLineCount","description":"エラー行のカウント","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strWorkFolderPath","description":"中間処理フォルダ","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strOutputFolderPath","description":"アウトプットフォルダのパス","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strErrorFolderPath","description":"エラー画像出力フォルダのパス","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strRootDir","description":"フレームワークを格納するフォルダのパスを設定してください。","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strLogFolderPath","description":"ログフォルダのパス","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"LastRow","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"wnExcel","description":"","type":"WINDOW","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"path":"C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE","class":"XLMAIN","handle":"9045948","isChild":false,"location":{"top":49,"left":49},"size":{"height":789,"width":1499},"presetType":"NONE","windowType":"NATIVE","browserTabUrl":"","nameRegex":{"type":"REGEX","list":[{"type":"PATTERN","string":"Excel"}],"regexFlags":{"caseInsensitive":false,"dotAll":false,"multiLine":false}}}}}],"breakpoints":[],"packages":[{"name":"Excel_MS","version":"5.4.0-20210117-080101"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"Window","version":"2.4.0-20210118-123115"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"Comment","version":"2.2.0-20201014-042520"},{"name":"System","version":"3.1.0-20210122-195716"},{"name":"Screen","version":"2.2.0-20210118-185815"},{"name":"TaskBot","version":"2.0.1-20210128-041521"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"LogToFile","version":"2.2.0-20201014-042806"},{"name":"Folder","version":"3.1.0-20210118-185034"},{"name":"Wait","version":"3.1.0-20210118-185841"},{"name":"Number","version":"2.1.0-20201014-042823"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"Datetime","version":"2.2.0-20210118-185018"}],"migrationJournalReviewIds":[],"workItemTemplateName":null}